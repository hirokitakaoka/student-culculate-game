# 計算パズルゲーム企画書

## 目的と目標
- 主要な目的：ゲームをプレイする中学生の計算力向上を目的とする。
- 達成すべき目標：中学生が継続的にプレイするくらいの面白さを担保すること。

## ゲームルール
- 2つの間違った計算式が画面に出される
- =以外の演算子は全て交換可能
- 正しい答えが出たら、その問題を正解とする
- 答え始めから10～20問くらい正解した時点での時間を測り、その時間が短いほど良い

## 操作方法
- マウス（PC）もしくはタップ（タブレット・スマホ）で演算子を選択する
- もう一つの演算子をクリック（タップ）すると、選択した２つの演算子が交換される

## デザインとレイアウト
- シンプルでモノクロなデザイン
- フォント：Roboto
- レスポンシブデザイン(HTML,CSS,Phaser.js)

## ユーザーインターフェース
1. **タイトル画面**
   - ゲームのロゴやタイトルを表示
   - 難易度の選択ボタン（簡単・中級・上級）
   - スタートボタン
   - 設定ボタン

2. **設定画面**
   - 音量調整スライダー
   - 効果音のオン・オフ切り替え
   - タイトル画面に戻るボタン

3. **ゲーム画面**
   - 画面上部にタイマーと正解数（例：6/10）をまとめて配置
   - 画面の中央に2つの間違った計算式を大きく表示
   - 選択された演算子を視覚的にわかりやすくする（色が変わる、下線が引かれるなど）
   - 画面右下に、効果音とBGMのオン・オフボタンを小さく配置

4. **リザルト画面**
   - 合計タイムを表示
   - リーダーボード（上位10名）を表示
   - プレイヤーが名前を入力してタイムを保存できるフォーム
   - タイトル画面に戻るボタン

## 難易度
1. **簡単**
   - 演算子：+ と × のみ
   - 数値の範囲：1 ～ 10
   - 演算子の数：各式に2つずつ
   - 例：a + b + c, a × b × c
2. **中級**
   - 演算子：+, -, × のみ
   - 数値の範囲：1 ～ 20
   - 演算子の数：各式に3つずつ
   - 例：a + b + c - d, a × b × c / d
3. **上級**
   - 演算子：+, -, ×, ÷
   - 数値の範囲：1 ～ 30
   - 演算子の数：各式に4つずつ
   - 例：a + b + c - d + e, a × b × c / d * e

## 問題生成方法
1. 難易度に応じた数字の範囲と演算子の種類を選択する
2. 2つの正しい計算式を生成する（除算が含まれる場合、正しい計算式を作成する段階で答えが整数になるように数値の組み合わせを選ぶ）
3. 生成した正しい計算式から演算子を取り出し、ランダムに並び替える
4. 並び替えた結果が正しい計算式にならないことを確認し、もし正しい計算式になってしまった場合は再度問題を生成する
5. 並び替えた結果が間違った計算式になることを確認したら、それをゲームに表示する

## スコアリングとランキング機能
- スコアは経過時間そのものを使用
- 各難易度ごとにランキングを保存
- ゲームをクリアするたびに、スコアがサーバーに送信される
- サーバー側で、各難易度ごとにスコアを保存し、上位10位までのランキングを生成する。
- リザルト画面で、プレイヤーの名前入力フォームとともに、その難易度の上位10位までのランキングを表示。

## プレイヤー名
- 半角英字のみ
- 10文字まで

# ゲームのテクノロジーと構成およびセキュリティ

## 使用技術
1. フロントエンド
   - HTML
   - CSS
   - JavaScript
     - Phaser (ゲームエンジン)
2. データベース
   - Firebase
     - Realtime Database または Firestore

## システム構成
- GitHub PagesでHTML, CSS, JavaScript（Phaserを含む）をホストし、フロントエンドとして動作させる。
- データベースとしてFirebaseのRealtime DatabaseかFirestoreを使用。これらのデータベースはフロントエンドコードから直接アクセスできるため、バックエンドの開発が不要になる。


## セキュリティとプライバシー

1. **データベースのセキュリティルール**: FirebaseのRealtime DatabaseやFirestoreでは、データベースへのアクセス権を制限するセキュリティルールを設定できます。不正なアクセスを防ぐため、適切なルールを設定しましょう。

2. **プレイヤー名に関する取り扱い**: プレイヤー名は半角英字のみで10文字以内に制限していますが、不適切な名前の登録を防ぐため、フィルタリングやサニタイジングを行うことが望ましいです。

3. **HTTPSの使用**: GitHub PagesはデフォルトでHTTPSを使用しますが、HTTPSを使用することで通信の暗号化を行い、第三者によるデータの傍受を防ぐことができます。

4. **クロスサイトスクリプティング（XSS）対策**: プレイヤー名など、ユーザーが入力したデータを表示する際には、エスケープ処理を行うことでXSS攻撃を防ぐことができます。

5. **ランキングデータの改ざん防止**: ゲーム内のランキングデータを改ざんされる可能性があります。Firebaseのセキュリティルールやバリデーションを適切に設定することで、不正なデータの登録を防ぐことができます。

## ファイル構成
student-culculate-game/
│
├── assets/
│   ├── fonts/
│   │   └── Roboto-Regular.ttf
│   └── sounds/
│       ├── bgm.mp3
│       ├── correct.mp3
│       └── wrong.mp3
│
├── css/
│   └── style.css
│
├── js/
│   ├── main.js
│   ├── scenes/
│   │   ├── configScene.js
│   │   ├── gameScene.js
│   │   ├── resultScene.js
│   │   └── titleScene.js
│   └── vendor/
│       └── phaser.min.js
│
├── index.html
└── README.md
